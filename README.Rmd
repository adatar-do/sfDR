---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# sfDR <a href="https://adatar-do.github.io/sfDR/"><img src="man/figures/logo.png" align="right" height="120" alt="sfDR website" /></a>

<!-- badges: start -->
[![Project Status: WIP â€“ Initial development is in progress, but there has not yet been a stable, usable release suitable for the public.](https://www.repostatus.org/badges/latest/wip.svg)](https://www.repostatus.org/#wip)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
![r-universe](https://adatar-do.r-universe.dev/badges/sfDR)
<!-- badges: end -->

The goal of sfDR is to provide a comprehensive suite of simple feature (sf) objects for the administrative boundaries of the Dominican Republic, facilitating geospatial analysis and mapping.

## Installation

You can install the development version of sfDR from r-universe with:

```{r}
if (!require('sfDR')) install.packages('sfDR', repos = c('https://adatar-do.r-universe.dev'))
if (!require('dplyr')) install.packages('dplyr')
if (!require('ggplot2')) install.packages('ggplot2')
```

## Example

This is a basic example showing how to use sfDR to plot a Dominican Republic province map:

```{r}
library(sfDR)
library(dplyr)

DR_PROV_SF <- sf::st_as_sf(DR_PROV)

plot(DR_PROV_SF)
```

Suppose you have a dataset showing the percentage distribution of remittances received in each province of the Dominican Republic for a specific year. To visualize this data using a graph with sfDR, you first need to combine the metadata with the simple features.


```{r}
DR_PROV_SF <- DR_PROV_SF |>
  left_join(dr_province, by = join_by(PROV_ID))

DR_PROV_SF %>% 
  sf::st_drop_geometry()
```

The original simple features dataset only includes the PROV_ID variable. Additional variables are incorporated through the dr_province object.

```{r}
 datos <- DR_PROV_SF |>
  left_join(remesas_provincias, by = join_by('PROV_NAME' == 'province'))

datos %>% 
  sf::st_drop_geometry()
```

It's important to note that non-ASCII characters can become corrupted when stored in the package, which may affect the merging of the data sets.

> We recommend cleaning any errors before performing the merge. We will soon release another package with functions designed to facilitate this process.

```{r}
datos |>
  select(percentage) %>% 
  plot()
```

To get the desired graph, just apply the plot function to your data.

Next, we show how to achieve a similar result using ggplot2. This serves to demonstrate how to create maps with both libraries and to highlight the simplicity of the process by integrating everything in one step.

```{r}
library(ggplot2)

DR_PROV %>%
  sf::st_as_sf() %>% 
  left_join(dr_province) %>% 
  left_join(remesas_provincias, by = join_by('PROV_NAME' == 'province')) %>% 
  ggplot() +
  geom_sf(aes(fill = percentage)) +
  theme_void()
```

